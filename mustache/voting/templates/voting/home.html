{% extends 'base.html' %}

{% block extrastyle %}

    <style>
        .gentleman { border-bottom: solid 1px #ccc; padding-bottom: 1em;}
        .voting label { font-size: 16px; }
    </style>

{% endblock %}

{% block content %}
<ul class="list-unstyled">
{% if gentlemen|length %}
    {% for g in gentlemen %}
    <li>
        <section class="gentleman row">
            <h2>{{g.name}} <small>{{g.tagline}}</small></h2>
            <section class="before col-2 col-lg-3">
                <h3>Before</h3>
                {% if g.before_pic %}
                <a href="{{ g.before_pic.url }}"><img src="{{ g.before_pic_resized.url }}" /></a>
                {% else %}
                <a href="#"><img src="http://placehold.it/200x200" /></a>
                {% endif %}
            </section>
            <section class="after col-2 col-lg-4">
                <h3>After</h3>
                {% if g.after_pic %}
                <a href="{{ g.after_pic.url }}"><img src="{{ g.after_pic_resized.url }}" /></a>
                {% else %}
                <a href="#"><img src="http://placehold.it/200x200" /></a>
                {% endif %}
            </section>
            <section class="voting col-12 col-lg-5">
                <h3>Vote for this gentleman</h3>
                <form method="post" action="{% url 'voting:vote' %}">
                    {% csrf_token %}
                    <input type="hidden" name="gentleman_id" value="{{ g.id }}" />
                    <fieldset>
                        <section class="form-group">
                            <input id="grooming{{forloop.counter}}" name="grooming" type="checkbox"{% if user.vote.grooming == g %}checked="checked"{% endif %} value="True" />
                            <label for="grooming{{forloop.counter}}">
                                Best Grooming
                                {% if user.vote.grooming and user.vote.grooming != g %}
                                <small>(previously voted for {{user.vote.grooming.name}})</small>
                                {% endif %}
                            </label>
                        </section>
                        <section class="form-group">
                            <input id="execution{{forloop.counter}}" name="execution" type="checkbox"{% if user.vote.execution == g %}checked="checked"{% endif %} value="True" />
                            <label for="execution{{forloop.counter}}">
                                Finest Execution
                                {% if user.vote.execution and user.vote.execution != g %}
                                <small>(previously voted for {{user.vote.execution.name}})</small>
                                {% endif %}
                            </label>
                        </section>
                        <section class="form-group">
                            <input id="creativity{{forloop.counter}}" name="creativity" type="checkbox"{% if user.vote.creativity == g %}checked="checked"{% endif %} value="True" />
                            <label for="creativity{{forloop.counter}}">
                                Most Creative
                                {% if user.vote.creativity and user.vote.creativity != g %}
                                <small>(previously voted for {{user.vote.creativity.name}})</small>
                                {% endif %}
                            </label>
                        </section>
                        <button type="submit" class="btn btn-lg btn-primary">Vote</button>
                    </fieldset>
                </form>
            </section>

            <!-- comments section -->
            <section class="clearfix">
                <h4 class="pointer" data-toggle="collapse" data-target="#comments{{forloop.counter}}">Comments about {{g.name}} &raquo;</h4>
                <div id="comments{{forloop.counter}}" class="in col-12">
                    {% if g.comment_set.count %}
                    <ul class="list-unstyled">
                    {% for c in g.comment_set.all %}
                        <li>
                            <h4>{{c.poster.username}} <small>{{c.timestamp}}</small></h4>
                            <p>{{c.text}}</p>
                        </li>
                    {% endfor %}
                    </ul>
                    {% endif %}
                    <form class="col-12" action="{% url 'voting:comment' %}">
                        {% csrf_token %}
                        <input type="hidden" name="gentleman_id" value="{{g.id}}" />
                        <fieldset>
                            <section class="form-group col-sm-8">
                                {{ comment_form.text }}
                            </section>
                        </fieldset>
                        <button type="submit" class="btn btn-sm">Comment</button>
                    </form>
                </div>
            </section>

            <!-- end comments section -->

        </section>
    </li>
    {% endfor %}
{% else %}
    <strong>No participants yet!</strong>
{% endif %}
{% endblock %}
